        -:    0:Source:/home/david/Programming/wakaamaNode/src/server.c
        -:    0:Graph:/home/david/Programming/wakaamaNode/b/CMakeFiles/TestsWithPosix.dir/home/david/Programming/wakaamaNode/src/server.c.gcno
        -:    0:Data:-
        -:    0:Runs:0
        -:    0:Programs:0
        -:    1:#include "lwm2m/server.h"
        -:    2:#include "internal.h"
        -:    3:#include "wakaama/internals.h"
        -:    4:#include "lwm2m/debug.h"
        -:    5:#include "lwm2m/network.h"
        -:    6:#include "network/network_common.h"
        -:    7:
        -:    8:#if defined(LWM2M_WITH_DTLS) && defined(LWM2M_SERVER_MODE)
    #####:    9:void lwm2m_server_dtls_psk(lwm2m_context_t * context, const char* publicId, const char* psk, unsigned short pskLen) {
    #####:   10:    network_t* network = (network_t*) context->userData;
    #####:   11:    if (network->secretKey) {
    #####:   12:        lwm2m_free(network->secretKey);
    #####:   13:        network->secretKey=NULL;
    #####:   14:        network->secretKeyLen=0;
        -:   15:    }
        -:   16:
    #####:   17:    if (network->publicIdentity) {
    #####:   18:        lwm2m_free(network->publicIdentity);
    #####:   19:        network->publicIdentity=NULL;
    #####:   20:        network->publicIdLen=0;
        -:   21:    }
        -:   22:
    #####:   23:    if (publicId == NULL || psk == NULL) {
    #####:   24:        network->dtls = false;
    #####:   25:        network->publicIdentity = NULL;
        -:   26:    } else {
    #####:   27:        network->dtls = true;
    #####:   28:        network->publicIdLen = (unsigned short)strlen(publicId);
    #####:   29:        network->publicIdentity = lwm2m_malloc(network->publicIdLen+1);
    #####:   30:        strcpy(network->publicIdentity, publicId);
        -:   31:    }
        -:   32:
    #####:   33:    if (psk) {
    #####:   34:       network->secretKey = lwm2m_malloc(pskLen);
    #####:   35:       memcpy(network->secretKey, psk, pskLen);
    #####:   36:       network->secretKeyLen = pskLen;
        -:   37:    }
    #####:   38:}
        -:   39:#else
        -:   40:void lwm2m_server_dtls_psk(lwm2m_context_t * context, const char* publicId, const char* psk, unsigned short pskLen) {}
        -:   41:#endif
